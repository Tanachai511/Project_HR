{# myapp/templates/admin/myapp/job/change_list.html #}
{% extends "admin/change_list.html" %}
{% load humanize static %}

{% block result_list %}
  <style>
    .job-card { transition: transform .15s ease, box-shadow .15s ease; }
    .job-card:hover { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(0,0,0,.08); }
    .line-clamp-3 { display: -webkit-box; -webkit-box-orient: vertical; overflow: hidden; }
    .job-thumb{
      width:100%; aspect-ratio: 3/4; background:#f6f7f9; display:grid; place-items:center; overflow:hidden;
      border-bottom: 1px solid #eee;
    }
    .job-thumb img{ width:100%; height:100%; object-fit:cover; }
  </style>

  <div class="row g-3">
    {% for obj in cl.result_list %}
      <div class="col-12 col-md-6 col-lg-4">
        <div class="card job-card h-100 shadow-sm">

          {# รูปโปสเตอร์ด้านบน #}
          <div class="job-thumb">
            {% if obj.job_image %}
              <img src="{{ obj.job_image.url }}" alt="{{ obj.job_name }}">
            {% else %}
              {# fallback ตามประเภทงาน (ต้องมีไฟล์ใน static) #}
              {% with fname=obj.job_type|lower|add:'.jpg' %}
                <img src="{% static fname %}" alt="{{ obj.job_name }}">
              {% endwith %}
            {% endif %}
          </div>

          <div class="card-body d-flex flex-column">
            <div class="d-flex justify-content-between align-items-start mb-2">
              <h5 class="card-title mb-0">{{ obj.job_name }}</h5>
              <button class="btn-close" disabled aria-label="close"></button>
            </div>

            <div class="mb-2 text-muted small">
              <span class="badge bg-primary">{{ obj.get_job_type_display }}</span>
              {% if obj.job_salary %}
                <span class="ms-2">เงินเดือน: {{ obj.job_salary|intcomma }} บาท</span>
              {% endif %}
            </div>

            <p class="card-text line-clamp-3 mb-3">{{ obj.job_subhead }}</p>

            <div class="mt-auto d-flex gap-2">
              <a href="{% url 'admin:myapp_job_change' obj.pk %}" class="btn btn-sm btn-primary">แก้ไข</a>
              <a href="{% url 'admin:myapp_job_delete' obj.pk %}" class="btn btn-sm btn-outline-danger">ลบ</a>
            </div>
          </div>
        </div>
      </div>
    {% empty %}
      <div class="col-12">
        <div class="alert alert-info mb-0">ยังไม่มีรายการ</div>
      </div>
    {% endfor %}
  </div>
{% endblock %}
